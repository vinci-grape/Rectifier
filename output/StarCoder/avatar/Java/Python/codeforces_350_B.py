import java.util.* ; import java.io.* ; import java.util.* ; import java.io.* ; public class codeforces_350_B { static Scanner scanner = new Scanner ( System.in ) ; public static void main ( String [ ] args ) { int n = scanner.nextInt ( ) ; int a [ ] = new int [ n + 1 ] ; int b [ ] = new int [ n + 1 ] ; int num [ ] = new int [ n + 1 ] ; for ( int i = 1 ; i <= n ; i ++ ) a [ i ] = scanner.nextInt ( ) ; for ( int i = 1 ; i <= n ; i ++ ) b [ i ] = scanner.nextInt ( ) ; for ( int i = 1 ; i <= n ; i ++ ) num [ b [ i ] ] ++ ; String ss = "" ; int ans = 0 ; boolean st [ ] = new boolean [ n + 1 ] ; for ( int i = 1 ; i <= n ; i ++ ) { if ( a [ i ] == 1 ) { st [ i ] = true ; StringBuilder sb = new StringBuilder ( ) ; int x = b [ i ] ; StringBuilder sss = new StringBuilder ( ) ; sss.append ( i ) ; sb.append ( " " + sss.reverse ( ) ) ; int s = 1 ; while (! st [ x ] && num [ x ] == 1 && x!= 0 && a [ x ]!= 1 ) { sss = new StringBuilder ( ) ; sss.append ( x ) ; sb.append ( " " + sss.reverse ( ) ) ; st [ x ] = true ; x = b [ x ] ; s ++ ; } if ( s > ans ) { ans = s ; ss = sb.reverse ( ).toString ( ) ; } } } System.out.println ( ans ) ; System.out.println ( ss ) ; } }